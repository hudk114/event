!function(t,o){"object"==typeof exports&&"undefined"!=typeof module?module.exports=o():"function"==typeof define&&define.amd?define(o):t.event=o()}(this,function(){"use strict";function t(t){this.pool={},this.prepare=t}function o(t,o){this.cb=t,this.once=o,this.done=!1}var n=function(t){return"function"==typeof t};return t.prototype={constructor:t,setPrepare:function(t){this.prepare=t},_getPool:function(t){var o="function"==typeof this.prepare?this.prepare:function(t,o){return t===o};for(var n in this.pool)if(this.pool.hasOwnProperty(n)&&o(n,t))return this.pool[n];return this.pool[t]||(this.pool[t]={stop:!0,list:[]}),this.pool[t]},_createPool:function(t){return this._getPool(t)||(this.pool[t]={stop:!0,list:[]}),this._getPool(t)},on:function(t,e,i){if(n(e)){var r=new o(e.bind(i),!1);return this._createPool(t).list.push(r),r}},once:function(t,e,i){if(n(e)){var r=new o(e.bind(i),!0);return this._createPool(t).list.push(r),r}},trigger:function(t,o){var n=this._getPool(t),e=null;if(n){for(var i in n.stop=!1,n.list){if(e=n.list[i],n.stop)return;e.once&&e.done||e.cb(o),e.once&&(e.done=!0)}n.list=n.list.filter(function(t){return!t.once||!t.done}),n.stop=!0}},stop:function(t){var o=this._getPool(t);o&&(o.stop=!0)},remove:function(t,o){var n=this._getPool(t).list.findIndex(function(t){return t===o});if(n<0)return null;this._getPool(t).list.splice(n,1)}},t});
